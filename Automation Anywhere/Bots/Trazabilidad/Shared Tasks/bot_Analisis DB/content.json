{"triggers":[],"nodes":[{"uid":"95800b30-111e-400e-a864-b1cd67be50ef","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Descripción del Task"}}]},{"uid":"56358a65-e900-4bdd-a834-4cd914313336","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"8a08b28f-dc21-4420-bad4-392ade94bbad","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Inicio variables de inicio para modo desarrollo"}}]},{"uid":"6b18a207-68a5-4116-af66-3c1b035590cd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Definir nombre BOT en vBotName"}}]},{"uid":"b4e0185a-2dcc-4fdf-bf3c-efceb622b2f8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Trazabilidad Comercializadora"}}],"returnTo":{"type":"VARIABLE","variableName":"vBotName"}},{"uid":"2a198db3-0cbe-4b9a-bd0c-54b0e8d364af","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd-MM-yyyy"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaEjecucion"}},{"uid":"aa66197c-622b-42fe-b34c-c67f54e08bbe","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"GetDocumentsFolder"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Trazabilidad/Assets/Scripts/GetDocumentsFolder.vbs"}}]},{"uid":"ca9df087-9988-4410-aca7-97513dcfe134","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"GetDocumentsFolder"}},{"name":"functionName","value":{"type":"STRING","string":"GetDocumentsFolder"}}],"returnTo":{"type":"VARIABLE","variableName":"dirDocumentos"}},{"uid":"c3e71689-c6f7-423b-b5d2-86ba416a508e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirDocumentos$\\$vBotName$\\$vFechaEjecucion$"}}],"returnTo":{"type":"VARIABLE","variableName":"dirTemp"}},{"uid":"3c64b924-bf98-4430-908a-22696219b298","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirTemp$\\Procesados"}}],"returnTo":{"type":"VARIABLE","variableName":"dirProcesados"}},{"uid":"ffa84d5d-62d2-4d2c-8f28-cd2bf963c834","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirTemp$\\Pendientes"}}],"returnTo":{"type":"VARIABLE","variableName":"dirPendientes"}},{"uid":"01023721-60f8-4b76-ad32-7e5fe254305a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirTemp$\\Logs"}}],"returnTo":{"type":"VARIABLE","variableName":"dirLog"}},{"uid":"19159f83-4750-4ee8-97df-bcacde02fabd","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirLog$\\$vBotName$ $vFechaEjecucion$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vLog"}},{"uid":"f8f055df-f16a-4cc5-b433-e3f12dddd1af","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vbotname$\n$vFechaEjecucion$\n$dirDocumentos$\n$dirTemp$\n$dirProcesados$\n$dirPendientes$\n$dirLog$\n$vLog$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"99bf042b-7396-4387-9d9c-4fc011ee3b2e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Fin variables de inicio para modo desarrollo"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","boolean":false}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]},{"uid":"88c23541-869d-4a21-a271-82cc59024e73","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Inicio variables de inicio del Task"}}]},{"uid":"17788b04-9720-42b2-9112-d28217ba853d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Definir nombre Task en vTaskName"}}]},{"uid":"04eb3654-2728-4af3-8040-4d7f2b59159e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Analisis DB"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskName"}},{"uid":"d17bc6a7-6148-426b-8c7f-2b0c5b70a6ee","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"vTaskCounter indica numero de inicios desde Main Task"}}]},{"uid":"dd20b01e-47ab-4723-989f-4a5e5e259193","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vTaskCounter$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vStringTaskCounter"}},{"uid":"d7407d93-185b-45f6-ba06-c1a35bcba2d7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Fin variables de inicio del Task"}}]},{"uid":"9dced8a0-f3ca-439b-b6a8-4067db89ec8c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"//////// Inicio Task ////////"}}]},{"uid":"1d0b487a-aada-4fa5-86d4-047ee692cfc9","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- [$vTaskName$] Iniciando Task ($vStringTaskCounter$)"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"66cf7a98-508b-4e09-8d6a-e72cd847ff24","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"52db0056-26f4-4325-81a2-90a711f971ca","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","string":"INFO- Conectando a DB via OLEDB"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"38c9f05c-6293-478c-8027-279f10e05980","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"$@vDBPath$\";Extended Properties=\"Excel 12.0;HDR=YES\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"fb8f7ce6-e57c-42d3-bb96-c314e2daa2f8","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"$@vDBPath$\";Extended Properties=\"Excel 12.0;HDR=YES\""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"79acfc3d-4253-409f-90c3-c8ead06f357d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","string":"INFO- Sesion establecida"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"372bf82d-f0bd-46db-aeab-4d16d3245af5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","string":"INFO- Consultando Query para estados != 90 y 00"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"36f4c1f6-5109-461e-b503-c571eaf4b37e","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"query","value":{"type":"STRING","string":"SELECT * FROM [Nuevo$] WHERE Estado BETWEEN 20 AND 50"}},{"name":"timeOut","value":{"type":"NUMBER","number":"30"}}],"returnTo":{"type":"VARIABLE","variableName":"tTrazabilidad"}},{"uid":"547e6525-8496-457a-b7e0-81f95a873add","commandName":"getNumberOfRows","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"tTrazabilidad"}},{"name":"rowCountSelection","value":{"type":"STRING","string":"totalRowSelection"}}],"returnTo":{"type":"VARIABLE","variableName":"vFilasTablaTrazabilidad"}},{"uid":"bf7815d0-37de-496a-9d1d-3e136de1a790","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vFilasTablaTrazabilidad$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vStringFilasTablaTrazabilidad"}},{"uid":"690369b6-9a55-4056-8880-8fcd5743723d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- Elementos encontrados: $vStringFilasTablaTrazabilidad$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"7c290c19-d624-4c4d-8a95-4d9549a35df7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"893e5dbb-1e3b-4c9c-9302-3c1a95876740","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $rFilaQueryTrazabilidad[0]$ $rFilaQueryTrazabilidad[1]$ $rFilaQueryTrazabilidad[2]$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"bde439d1-25e9-4f17-ae2a-3f9a3aa456e6","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Fecha: $rFilaQueryTrazabilidad[0]$ Folio Origen: $rFilaQueryTrazabilidad[1]$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rFilaQueryTrazabilidad"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"tTrazabilidad"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"branches":[{"uid":"171e9404-0051-4a28-9e3f-7cb892ee601b","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]},{"uid":"672c4bdb-db08-4b54-8a38-a7554df1ef2e","commandName":"writeToFile","packageName":"DataTable","disabled":true,"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"tTrazabilidad"}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/3rd-Alberto.Peters/Documents/test.csv"}},{"name":"createDirectories","value":{"type":"BOOLEAN","boolean":true}},{"name":"appendToExistingFile","value":{"type":"STRING","string":"overwrite"}},{"name":"rowDelimiter","value":{"type":"STRING","string":"NEW_LINE"}},{"name":"columnDelimiter","value":{"type":"STRING","string":"COMMA"}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"isProductionMode","description":"Modo producción desde Main Task","type":"BOOLEAN","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"vFechaEjecucion","description":"Fecha de ejecucion del Task","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirDocumentos","description":"Path /Documents TE ODIO NUEVA VERSION TE ODIOOOO","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirLogIndividual","description":"Directorio del log de cada documento","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vLog","description":"Log del proceso","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogIndividual","description":"Log del documento","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirProcesados","description":"Directorio documentos procesados del dia","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirPendientes","description":"Directorio documentos no procesados del dia","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirLogMain","description":"Directorio del log del proceso","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirTemp","description":"Directorio documentos en ejecucion/cola","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBotName","description":"Nombre del Bot en ejecucion","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirLog","description":"Directorio de la carpeta de Logs","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTaskCounter","description":"Cantidad de inicios de este Subtask","type":"NUMBER","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"NUMBER","number":"1"}},{"name":"vStringTaskCounter","description":"vTaskCounter (INT) Pasado a String","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTaskName","description":"Nombre del Task","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vError","description":"Error del Task","type":"BOOLEAN","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vErrorLineNumber","description":"Error en Linea:","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vErrorMsg","description":"Error Mensaje","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vStringErrorLineNumber","description":"String de vStringErrorLineNumber","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"tTrazabilidad","description":"Tabla de trazabilidad desde Query en DB","type":"TABLE","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"rFilaQueryTrazabilidad","description":"Fila correspondiente a la tabla Query de la DB","type":"RECORD","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vFilasTablaTrazabilidad","description":"Cantidad de filas de tabla desde query en DB","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vStringFilasTablaTrazabilidad","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vFechaDeclaracion","description":"Fecha de declaracion del recurso","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolioOrigen","description":"Folio de origen Proveedor","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolioDestino","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaGuia","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolioAbastecimiento","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20201126-165109"},{"name":"Comment","version":"2.3.0-20201126-165125"},{"name":"DataTable","version":"2.5.0-20201201-130615"},{"name":"Database","version":"2.2.0-20201112-223343"},{"name":"Datetime","version":"2.2.0-20201126-165136"},{"name":"ErrorHandler","version":"2.3.0-20201126-165148"},{"name":"If","version":"2.1.0-20201126-165201"},{"name":"LogToFile","version":"2.2.0-20201126-165428"},{"name":"Loop","version":"2.1.0-20201126-165429"},{"name":"MessageBox","version":"2.1.0-20201126-165430"},{"name":"Number","version":"2.1.0-20201126-165444"},{"name":"String","version":"3.1.0-20201126-165909"},{"name":"System","version":"3.0.0-20200921-090225"},{"name":"VBScript","version":"2.4.0-20201208-065526"}],"workItemTemplateName":null}