{"triggers":[],"nodes":[{"uid":"95800b30-111e-400e-a864-b1cd67be50ef","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Descripción del Task"}}]},{"uid":"56358a65-e900-4bdd-a834-4cd914313336","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"8a08b28f-dc21-4420-bad4-392ade94bbad","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Inicio variables de inicio para modo desarrollo"}}]},{"uid":"6b18a207-68a5-4116-af66-3c1b035590cd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Definir nombre BOT en vBotName"}}]},{"uid":"b4e0185a-2dcc-4fdf-bf3c-efceb622b2f8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Trazabilidad Abastecimiento"}}],"returnTo":{"type":"VARIABLE","variableName":"vBotName"}},{"uid":"2a198db3-0cbe-4b9a-bd0c-54b0e8d364af","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd-MM-yyyy"}}],"returnTo":{"type":"VARIABLE","variableName":"vFechaEjecucion"}},{"uid":"aa66197c-622b-42fe-b34c-c67f54e08bbe","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"GetDocumentsFolder"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"'Ojo es una funcion!\nFunction GetDocumentsFolder()\nDim objShell\nSet objShell = CreateObject(\"WScript.Shell\")\nGetDocumentsFolder = objShell.SpecialFolders(\"MyDocuments\")\nEnd Function"}}]},{"uid":"ca9df087-9988-4410-aca7-97513dcfe134","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"GetDocumentsFolder"}},{"name":"functionName","value":{"type":"STRING","string":"GetDocumentsFolder"}}],"returnTo":{"type":"VARIABLE","variableName":"dirDocumentos"}},{"uid":"c3e71689-c6f7-423b-b5d2-86ba416a508e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirDocumentos$\\$vBotName$\\$vFechaEjecucion$"}}],"returnTo":{"type":"VARIABLE","variableName":"dirTemp"}},{"uid":"3c64b924-bf98-4430-908a-22696219b298","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirTemp$\\Procesados"}}],"returnTo":{"type":"VARIABLE","variableName":"dirProcesados"}},{"uid":"ffa84d5d-62d2-4d2c-8f28-cd2bf963c834","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirTemp$\\Pendientes"}}],"returnTo":{"type":"VARIABLE","variableName":"dirPendientes"}},{"uid":"01023721-60f8-4b76-ad32-7e5fe254305a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirTemp$\\Logs"}}],"returnTo":{"type":"VARIABLE","variableName":"dirLog"}},{"uid":"19159f83-4750-4ee8-97df-bcacde02fabd","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirLog$\\$vBotName$ $vFechaEjecucion$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vLog"}},{"uid":"596c81d9-5c54-463c-8f90-6654fa98b31d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dirLog$\\Log $vGuiaDespacho$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogIndividual"}},{"uid":"f8f055df-f16a-4cc5-b433-e3f12dddd1af","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vbotname$\n$vFechaEjecucion$\n$dirDocumentos$\n$dirTemp$\n$dirProcesados$\n$dirPendientes$\n$dirLog$\n$vLog$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"83162dc5-0ed4-463e-a24c-30f1f6c06a62","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"[$vTaskName$] [$vStringCounterTablaTrazabilidad$/$vStringFilasTablaTrazabilidad$] [$vGuiaDespacho$]"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogHeader"}},{"uid":"99bf042b-7396-4387-9d9c-4fc011ee3b2e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Fin variables de inicio para modo desarrollo"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$isProductionMode$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]},{"uid":"88c23541-869d-4a21-a271-82cc59024e73","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Inicio variables de inicio del Task"}}]},{"uid":"17788b04-9720-42b2-9112-d28217ba853d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Definir nombre Task en vTaskName"}}]},{"uid":"04eb3654-2728-4af3-8040-4d7f2b59159e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Actualizacion DB"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskName"}},{"uid":"d17bc6a7-6148-426b-8c7f-2b0c5b70a6ee","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"vTaskCounter indica numero de inicios desde Main Task"}}]},{"uid":"dd20b01e-47ab-4723-989f-4a5e5e259193","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vTaskCounter$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vStringTaskCounter"}},{"uid":"414779f1-f815-4cb0-8581-168e3eec105f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Variable Header"}}]},{"uid":"4706497b-3a8b-4709-9a4a-967064c3b6c3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"[$vTaskName$] [$vStringCounterTablaTrazabilidad$/$vStringFilasTablaTrazabilidad$] [$vGuiaDespacho$]"}}],"returnTo":{"type":"VARIABLE","variableName":"vLogHeader"}},{"uid":"d7407d93-185b-45f6-ba06-c1a35bcba2d7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Fin variables de inicio del Task"}}]},{"uid":"9dced8a0-f3ca-439b-b6a8-4067db89ec8c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"//////// Inicio Task ////////"}}]},{"uid":"1d0b487a-aada-4fa5-86d4-047ee692cfc9","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Iniciando Task ($vStringTaskCounter$)"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"66cf7a98-508b-4e09-8d6a-e72cd847ff24","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"52db0056-26f4-4325-81a2-90a711f971ca","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Conectando a DB via OLEDB"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"6de9b18e-5652-4ee8-af98-755861c94e33","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Conectando a DB via OLEDB"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"38c9f05c-6293-478c-8027-279f10e05980","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"$@vDBPath$\";Extended Properties=\"Excel 12.0;HDR=YES\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"06c2e7a9-0717-44e3-a003-c7dca0d01c45","commandName":"logToFile","packageName":"LogToFile","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"$@vDBPath$\";Extended Properties=\"Excel 12.0;HDR=YES\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"952d0ba3-f0a7-43a8-8efa-babc13cae452","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"07fdeb8e-845c-4adc-8808-5af67215d4fd","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"C:\\Users\\3rd-Alberto.Peters\\Documents\\Resumen declaraciones 2021_00.xlsx\";Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"675c8b4d-3021-400a-b8ef-8e727c9f00cb","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"C:\\Users\\3rd-Alberto.Peters\\Documents\\Resumen declaraciones 2021_00.xlsx\";Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4ee6ae4d-7be6-4dc2-93cd-31f51429c7cc","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","string":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"\\\\chi-san-p-rpa01\\RPA - Mowi\\Trazabilidad Plantas\\Caicaen\\Resumen declaraciones 2021_00.xlsx\";Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"a3d0d903-c9ad-4717-af58-01e8092c5330","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"ddada1dc-652f-42ed-a490-60ed9480835a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"$@vDBPath$\";Extended Properties=\"Excel 12.0;HDR=YES\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f7ea5789-7c9b-4208-bf39-0fe00fc8a01a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"$@vDBPath$\";Extended Properties=\"Excel 12.0;HDR=YES\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"fb8f7ce6-e57c-42d3-bb96-c314e2daa2f8","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"$@vDBPath$\";Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBotName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Trazabilidad Comercializadora"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBotName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Trazabilidad Abastecimiento"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"b251c7b3-f8e3-42af-a658-23c065862d9e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Sesion establecida"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"79acfc3d-4253-409f-90c3-c8ead06f357d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Sesion establecida"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"372bf82d-f0bd-46db-aeab-4d16d3245af5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Actualizando Folio y Estado para Guia: $vGuiaDespacho$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"3d9d0ecc-d057-48db-b733-78731e8a2aba","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Actualizando Folio y Estado para Guia: $vGuiaDespacho$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"e667471e-c70b-4476-8cda-c172c9c3777d","commandName":"trim","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFolioAbastecimiento$"}},{"name":"trimAtBeginning","value":{"type":"BOOLEAN","boolean":true}},{"name":"trimAtEnd","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vFolioAbastecimiento"}},{"uid":"ac3dc66a-0f73-45ed-910e-37404c06a1bb","commandName":"trim","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFolioDestino$"}},{"name":"trimAtBeginning","value":{"type":"BOOLEAN","boolean":true}},{"name":"trimAtEnd","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vFolioDestino"}},{"uid":"3743cdf1-239a-417c-b1ec-74a52214d780","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"01f31ce2-5489-4888-8585-b01d85665122","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1ea48ee0-5d9e-48f2-bc19-59c183aeec1b","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"query","value":{"type":"STRING","expression":"UPDATE [Data$$] SET [Folio Abastecimiento] = '$vFolioAbastecimiento$', Estado = 'Declarado' WHERE [CAM]= '$vFolioDeclaracionOrigen$'"}}]}],"branches":[{"uid":"f3a0162a-1ff4-4e3d-9a26-3ee1bb241e5e","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"e52fbc53-da60-4af9-a686-67b3bd34032e","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"query","value":{"type":"STRING","expression":"UPDATE [Nuevo$$] SET [Folio Abastecimiento] = '$vFolioAbastecimiento$', Estado = '$vStatus$' WHERE GD= '$vGuiaDespacho$'"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBotName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Trazabilidad Comercializadora"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBotName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Trazabilidad Abastecimiento"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"690369b6-9a55-4056-8880-8fcd5743723d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Folio Actualizado: $vFolioAbastecimiento$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"bab23816-d840-4a37-bc72-8e79cc218d46","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Folio Actualizado: $vFolioAbastecimiento$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFolioAbastecimiento$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"5ee15a1e-12f6-41dc-a71e-7339c91768cf","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"349d27d0-332b-4669-90d3-b88748078bde","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"query","value":{"type":"STRING","expression":"UPDATE [Nuevo$$] SET [Folio Destino] = '$vFolioDestino$', Estado = '$vStatus$' WHERE GD = '$vGuiaDespacho$'"}}]},{"uid":"a4455a7d-d9df-4398-831c-387d873d75f3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Folio Actualizado: $vFolioDestino$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"55a443f6-6912-4d2b-a457-846a884c1e4f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Folio Actualizado: $vFolioDestino$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFolioDestino$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"61c5b2d6-ac3b-47be-b292-d13428ffec2f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"7cb454ae-99e9-4553-9f71-1dfc8bd503bf","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"0df786a3-fd9c-4a11-bdb0-f0d713cab834","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"00"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatus"}},{"uid":"8df6d643-c8b5-42b1-a62a-74972c30d8b0","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"query","value":{"type":"STRING","expression":"UPDATE [Data$$] SET Estado = 'No Declarado' WHERE [CAM]= '$vFolioDeclaracionOrigen$'"}}]},{"uid":"70a84b59-d209-46c3-8cc6-0e8445538305","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Estado Actualizado: $vStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8619a2f8-41ee-4b3e-95fa-a3863e21d4f2","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Estado Actualizado: $vStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"c4cb87b6-2964-42fd-8bb4-fb23f246fdbe","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"130edc3e-8462-4a94-a69c-4e0a9d585714","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"00"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatus"}},{"uid":"ace74f7a-b8f5-42d2-b5f9-ae3e1e6bc33a","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}},{"name":"query","value":{"type":"STRING","expression":"UPDATE [Nuevo$$] SET Estado = '$vStatus$' WHERE GD= '$vGuiaDespacho$'"}}]},{"uid":"3131ca54-083e-464a-9ca9-6dc8f9b08e9b","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Estado Actualizado: $vStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"54bbfa3b-0ea4-4ed6-8dee-b5e88c037888","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Estado Actualizado: $vStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBotName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Trazabilidad Comercializadora"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBotName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Trazabilidad Abastecimiento"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"8fd1f441-b46f-40c1-bfe1-e8199c5776af","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"5d5c0010-e598-4628-bc00-5d0b340bc7be","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Estado Actualizado: $vStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"6edef94c-2721-420e-9d2d-7784589aa628","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"INFO- $vLogHeader$ Estado Actualizado: $vStatus$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$vError$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"branches":[{"uid":"171e9404-0051-4a28-9e3f-7cb892ee601b","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"2bdb49fe-630c-4cd0-93eb-a5f9a26e9c97","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vStringErrorLineNumber"}},{"uid":"8951ee17-6674-4e55-b657-7f762b33600f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"ERROR- $vLogHeader$ $vErrorMsg$ in line $vStringErrorLineNumber$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"18024779-aeda-4705-82df-9b257ccb3bda","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"ERROR- $vLogHeader$ $vErrorMsg$ in line $vStringErrorLineNumber$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"42249274-c233-448a-9a93-c2501bd1d37c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"WARN- $vLogHeader$ No se puede establecer conexion a DB"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"aab21c41-6174-4ef8-93d9-64450c6defd5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vLogIndividual$"}},{"name":"logContent","value":{"type":"STRING","expression":"WARN- $vLogHeader$ No se puede establecer conexion a DB"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f8eda139-0342-4543-a79d-21e28fd6b02a","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vError"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]},{"uid":"b3bc4928-59d5-409d-a73b-089d762a4553","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Trazabilidad"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"isProductionMode","description":"Modo producción desde Main Task","type":"BOOLEAN","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"vFechaEjecucion","description":"Fecha de ejecucion del Task","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirDocumentos","description":"Path /Documents TE ODIO NUEVA VERSION TE ODIOOOO","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirLogIndividual","description":"Directorio del log de cada documento","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vLog","description":"Log del proceso","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogIndividual","description":"Log del documento","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirProcesados","description":"Directorio documentos procesados del dia","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirPendientes","description":"Directorio documentos no procesados del dia","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirLogMain","description":"Directorio del log del proceso","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirTemp","description":"Directorio documentos en ejecucion/cola","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBotName","description":"Nombre del Bot en ejecucion","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dirLog","description":"Directorio de la carpeta de Logs","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTaskCounter","description":"Cantidad de inicios de este Subtask","type":"NUMBER","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"NUMBER","number":"1"}},{"name":"vStringTaskCounter","description":"vTaskCounter (INT) Pasado a String","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTaskName","description":"Nombre del Task","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vError","description":"Error del Task","type":"BOOLEAN","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vErrorLineNumber","description":"Error en Linea:","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vErrorMsg","description":"Error Mensaje","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vStringErrorLineNumber","description":"String de vStringErrorLineNumber","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"tTrazabilidad","description":"Tabla de trazabilidad desde Query en DB","type":"TABLE","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"rFilaQueryTrazabilidad","description":"Fila correspondiente a la tabla Query de la DB","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vFilasTablaTrazabilidad","description":"Cantidad de filas de tabla desde query en DB","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vStringFilasTablaTrazabilidad","description":"String de vFilasTablaTrazabilidad","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaDeclaracion","description":"Fecha de declaracion del recurso","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolioOrigen","description":"Folio de origen Proveedor","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolioDestino","description":"Folio de Destino","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFechaGuia","description":"Fecha de la Guia","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolioAbastecimiento","description":"Folio de Abastecimiento","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vGuiaDespacho","description":"Numero de guia","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vStatus","description":"Estado del recurso","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBodega","description":"Bodega ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vRUTCliente","description":"Rut del cliente","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCodigoCliente","description":"Codigo del cliente en Sernapesca","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vPaisDestino","description":"Pais de destino","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTipoOrigen","description":"Tipo de origen de proveedor","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTon","description":"Toneladas a declarar","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCounterTablaTrazabilidad","description":"Counter de la tabla Query desde DB","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vStringCounterTablaTrazabilidad","description":"Strin de vCounterTablaTrazabilidad","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vLogHeader","description":"Header de cada ingreso en log","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolioDeclaracionOrigen","description":"Folio de origen Proveedor","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":["3743cdf1-239a-417c-b1ec-74a52214d780","5ee15a1e-12f6-41dc-a71e-7339c91768cf"],"packages":[{"name":"Boolean","version":"2.1.0-20201126-165109"},{"name":"Comment","version":"2.3.0-20201126-165125"},{"name":"Database","version":"2.2.0-20201112-223343"},{"name":"Datetime","version":"2.2.0-20201126-165136"},{"name":"ErrorHandler","version":"2.3.0-20201126-165148"},{"name":"If","version":"2.1.0-20201126-165201"},{"name":"LogToFile","version":"2.2.0-20201126-165428"},{"name":"MessageBox","version":"2.1.0-20201126-165430"},{"name":"Number","version":"2.1.0-20201126-165444"},{"name":"String","version":"3.1.0-20201126-165909"},{"name":"System","version":"3.0.0-20200921-090225"},{"name":"VBScript","version":"2.4.0-20201208-065526"}],"workItemTemplateName":null}